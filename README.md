# audit-middleware

A library for HIPAA-compliant audit logging in Pennsieve.

# Background

The Pennsieve gateway logs service requests into two Cloudwatch log streams: 
`plain` and `audit`. 

* the `plain` log should not contain PHI and is intended to be accessible by 
  engineers
* the `audit` log is a secure, auditted log of events generated by a user 
  action in the platform

Each request that comes through the gateway has a unique request ID assigned 
to it, intended for correlating events downstream of the request back. 

`audit-middleware` provides functionality to log arbitrary events in any
service using this library.

## Publishing

### To your local repository for testing

Any branch:

```
$ sbt publishLocal
```
or 
```
$ sbt +publishLocal
```
to test cross compilation

### A snapshot

Any branch (but usually should be `master`):

```
$ sbt +publish
```
This will build the jars as `_2.12` and `2.13` snapshots and push them to `maven-snapshots` on Nexus.

### A release

From your `master` branch:

```
$ sbt release cross
```

Follow the prompts to update the version and build the jars as official `_2.12` and `_2.13` 
releases and push them to `maven-releases` on Nexus.
